#include "../../tomb4/pch.h"

#include "../mod_config.h"

#include "../../game/gameflow.h"
#include "../../game/trng/trng.h"

int16_t T4PlusGetLaraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_slot;
}

int16_t T4PlusGetPistolsAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_pistols_animations_slot;
}

int16_t T4PlusGetUziAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_uzi_animations_slot;
}

int16_t T4PlusGetShotgunAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_shotgun_animations_slot;
}

int16_t T4PlusGetCrossbowAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_crossbow_animations_slot;
}

int16_t T4PlusGetGrenadeGunAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_grenade_gun_animations_slot;
}

int16_t T4PlusGetRevolverAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_revolver_animations_slot;
}

int16_t T4PlusGetFlareAnimSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_flare_animations_slot;
}

int16_t T4PlusGetLaraSkinSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_skin_slot;
}

int16_t T4PlusGetLaraSkinJointsSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_skin_joints_slot;
}

int16_t T4PlusGetLaraScreamSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_scream_slot;
}

int16_t T4PlusGetLaraCrossbowLaserSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_crossbow_laser;
}

int16_t T4PlusGetLaraRevolverLaserSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_revolver_laser;
}

int16_t T4PlusGetLaraHolstersSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_holsters;
}

int16_t T4PlusGetLaraHolstersPistolsSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_holsters_pistols;
}

int16_t T4PlusGetLaraHolstersUzisSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_holsters_uzis;
}

int16_t T4PlusGetLaraHolstersRevolverSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_holsters_revolver;
}

int16_t T4PlusGetLaraHairSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_hair_slot;
}

int16_t T4PlusGetMotorbikeSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->motorbike_slot;
}

int16_t T4PlusGetJeepSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->jeep_slot;
}

int16_t T4PlusGetMotorbikeExtraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->motorbike_extra_slot;
}

int16_t T4PlusGetJeepExtraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->jeep_extra_slot;
}

int16_t T4PlusGetMeshSwap1SlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->meshswap_1_slot;
}

int16_t T4PlusGetMeshSwap2SlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->meshswap_2_slot;
}

int16_t T4PlusGetMeshSwap3SlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->meshswap_3_slot;
}

int16_t T4PlusGetBubblesSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->bubbles_slot;
}

int16_t T4PlusGetDefaultSpritesSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->default_sprites_slot;
}

int16_t T4PlusGetHorizonSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->horizon_slot;
}

int16_t T4PlusGetSkyGraphicsSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->sky_graphics_slot;
}

int16_t T4PlusGetBinocularGraphicsSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->binocular_graphics_slot;
}

int16_t T4PlusGetTargetGraphicsSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->target_graphics_slot;
}

int16_t T4PlusGetLightningConductorTargetSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lightning_conductor_target_slot;
}

int16_t T4PlusGetRubberBoatSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->rubber_boat_slot;
}

int16_t T4PlusGetMotorBoatSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->motor_boat_slot;
}

int16_t T4PlusGetRubberBoatExtraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->rubber_boat_extra_slot;
}

int16_t T4PlusGetMotorBoatExtraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->motor_boat_extra_slot;
}

int16_t T4PlusGetHydraSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->hydra_slot;
}

int16_t T4PlusGetHydraMissileSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->hydra_missile_slot;
}

int16_t T4PlusGetChefSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->chef_slot;
}

int16_t T4PlusGetLaraDoubleSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->lara_double_slot;
}

int16_t T4PlusGetEnemyJeepSlotID() {
	return get_game_mod_level_objects_info(gfCurrentLevel)->enemy_jeep_slot;
}

void T4PlusSetupDefaultObjectCustomization() {
	MOD_LEVEL_OBJECTS_INFO *objects_info = get_game_mod_level_objects_info(0);

	for (int i = 0; i < NUMBER_OBJECTS; i++)
	{
		objects_info->object_customization[i].initialise_routine = "";
		objects_info->object_customization[i].collision_routine = "";
		objects_info->object_customization[i].control_routine = "";
		objects_info->object_customization[i].draw_routine = "DrawAnimatingItem";
		objects_info->object_customization[i].draw_routine_extra = "";
		objects_info->object_customization[i].ceiling_routine = "";
		objects_info->object_customization[i].floor_routine = "";

		objects_info->object_customization[i].is_amphibious = false;
		objects_info->object_customization[i].is_agent = false;
		objects_info->object_customization[i].is_undead = false;

		objects_info->object_customization[i].save_position = 0;
		objects_info->object_customization[i].save_hitpoints = 0;
		objects_info->object_customization[i].save_flags = 0;
		objects_info->object_customization[i].save_animation = 0;
		objects_info->object_customization[i].save_mesh = 0;

		objects_info->object_customization[i].pivot_length = 0;
		objects_info->object_customization[i].radius = 10;
		objects_info->object_customization[i].shadow_size = 0;

		objects_info->object_customization[i].explodable_meshbits = 0;
		//obj->frame_base = (short*)((long)(size_t(obj->frame_base) & 0xffffffff) + (char*)frames);
		//obj->object_mip = 0;
	}

	MOD_LEVEL_OBJECT_CUSTOMIZATION* obj;

	obj = &objects_info->object_customization[LARA];
	obj->initialise_routine = "InitialiseLaraLoad";
	obj->draw_routine = "";
	obj->shadow_size = 160;
	obj->hit_points = 1000;
	obj->save_hitpoints = 1;
	obj->save_position = 1;
	obj->save_flags = 1;
	obj->save_animation = 1;

	obj = &objects_info->object_customization[MOTORBIKE];
	obj->initialise_routine = "InitialiseBike";
	obj->control_routine = "BikeControl";
	obj->collision_routine = "BikeCollision";
	obj->draw_routine_extra = "DrawBikeExtras";
	obj->save_hitpoints = true;
	obj->save_position = true;
	obj->save_flags = true;
	obj->save_animation = true;
	//bones[obj->bone_index + 4] |= X_ROTATION_FLAG;
	//bones[obj->bone_index + 12] |= X_ROTATION_FLAG;
	//bones[obj->bone_index + 28] |= X_ROTATION_FLAG;

	obj = &objects_info->object_customization[JEEP];
	obj->initialise_routine = "InitialiseJeep";
	obj->control_routine = "JeepControl";
	obj->collision_routine = "JeepCollision";
	obj->draw_routine_extra = "DrawJeepExtras";
	obj->save_hitpoints = true;
	obj->save_position = true;
	obj->save_flags = true;
	obj->save_animation = true;
	//bones[obj->bone_index + 4] |= X_ROTATION_FLAG;
	//bones[obj->bone_index + 12] |= X_ROTATION_FLAG;
	//bones[obj->bone_index + 28] |= X_ROTATION_FLAG;
}

bool T4ObjectControlRoutine(short object_number, short item_num) {
	NGStoreLastItemMovedIndex(item_num);

	if (!NGIsItemFrozen(item_num)) {
		return true;
	} else {
		return false;
	}
}